

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Order History</title>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Stylesheet -->
    <link rel="stylesheet" href="OrderHistory.css">
  </head>
  <body>
    
    <header>
    
      <nav>
        <a href="#home" id="logo"> <img src="logo.png"></a>
        <div class="title-items"><a></a> Order History</a></div>

        <i class="fas fa-bars" id="ham-menu"></i>
        <ul id="nav-bar">
           
          <li>
            <a href="/">בית</a>
          </li>
          <li>
            <a href="aboutus">קצת עלינו</a>
          </li>
          <li>
            <a href="#collection">המוצרים שלנו</a>
            <div class="sub-menu-1">
              <ul>
                <li><a href="couch">ספות</a></li>
                <li><a href="armchairs">כסאות בר</a></li>
                <li><a href="table">שולחנות</a></li>
                <li><a href="chairs">כסאות</a></li>
                <li><a href="bed">מיטות</a></li>
             
                
    
            </ul>
            </div> 
        </li>
        <li>
          <a href="#decor">מוצרים נלווים</a>
           <div class="sub-menu-1">
            <ul>
                <li><a href="rug">מזרונים</a></li>
                <li><a href="mirror">חדרי ילדים</a></li>
            </ul>
              </div> 
          </li>
          <li>
            <a href="ContactUs">צור קשר</a>
          </li>

        <li>  <button class="btn-my-search" onclick="document.getElementById('id01').style.display='flex'"style="width:auto;"><i class="fas fa-search"></i></button>
        </li>
           <li>
            <li><a href="/Mybag" class="btn-Shopping-Cart"><i class="fas fa-shopping-cart"></i></a></li>
            
           </li>
           <li> <a href="/myAccount" class="btn-my-account"> <i class="fas fa-user"></i> </a> </li>

              <% if (alertMessage) { %>    
                  <li id="alert"> <%= alertMessage %>  </li>
                  <% } %>  
        </ul>
      </nav>
    </header>
    <div class=" OrderHis">

     
    
    <div class="orderflow"> 
      <div class="detailsHistory">
        <% if (typeof details !== 'undefined' && details) { %>
        <% for(let i =0;i<details.length;i++){ %>
        <% details[i].purHis.forEach(function(item){ %>
        <div class="detailsItems">
            <table>
                <tr>
                    
                  <th>תאריך</th>
                  <th>שם המוצר</th>
      
                  <th> פרטים</th>
                  <th>מחיר</th>
                  <th>כמות</th>
                </tr>

                <tr>
                  
                  <td>  <%= details[i].date %> : תאריך הקניה</td>
                   

                    <td>
                      <p>
                        <%= item.category %>
                        <br>
                        <a class="pic"><img src="<%= item.pic %>" alt="תמונת המוצר"></a>
                      </p>
                    </td>

                    <td>
                        <p>
                          <%= item.name %> : שם המוצר
                          <br>
                           <%= item.color %> : צבע 
                          <br>
                           <%= item.matter %> : חומר 
                        </p>
                    </td>
                    <td>₪ <%= item.price %></td>
                    <td><%= item.amount %></td>
                </tr>
            </table>
            
        </div>
        <% }) %>
        <% } %>
        <% } %>
    </div>
    <p><a  class="btn-primary" href="/myAccount">חזור</a></p>
          
        
    
    </div>
    </div>    
    </div> 
    </div>
     </div>
    <section id="home">
      
      <div class=" col-lg-3 sidebar">


        <% if (loggedIn) { %>
          <a> <p>  <%= user.name %>  ברוך שובך </p></a>
         <!--<p><a href="/orderHistory">Order History</a></p>יותם אתה צריך לממש את ההיסטוריה הזו  -->
         <a href="OrderHistory">היסטוריית הזמנות</a>
         <a class="active" id="OrderH" href="accountInformation">מידע על החשבון</a>
         <p><a href="changePassword">החלפת סיסמא</a></p>
          <!-- <p><a  href="/changePassword">Change Password</a></p> -->
        <% } else { %>
          <p>בבקשה <a href="/login">התחבר</a>על מנת להכנס לחשבון</p>
        <% } %>
   
   
        
       
        <div class="detailsHistory1">
          
            <% if (typeof details !== 'undefined' && details) { %>
              <% for(let i =0;i<details.length;i++){ %>
              <% details[i].purHis.forEach(function(item){ %>
                
                <div class="detailsItems">
                  
                  <table>
                    <tr>
                        
                        <th>תאריך</th>
                        <th>שם המוצר</th>
            
                        <th> פרטים</th>
                        <th>מחיר</th>
                        <th>כמות</th>
                    </tr>
    
                    <tr>
                      
                        <td>  <%= details[i].date %> : תאריך הקניה</td>
                       
    
                        <td>
                          <p>
                            <%= item.category %>
                            <br>
                            <a class="pic"><img src="<%= item.pic %>" alt="תמונת המוצר"></a>
                          </p>
                        </td>
    
                        <td>
                            <p>
                                 <%= item.name %> : שם המוצר
                                <br>
                                 <%= item.color %> : צבע 
                                <br>
                                 <%= item.matter %> : חומר 
                            </p>
                        </td>
                        <td>₪ <%= item.price %></td>
                        <td><%= item.amount %></td>
                    </tr>
                </table>
                
            </div>
            <% }) %>
            <% } %>
            <% } %>
        </div>
        
              
            
        
        </div>
        </div>    
        </div> 
        </div>
         </div>
      
        <% if (loggedIn) { %>
          <a id="logoutButton">התנתק</a>
      <% } else { %>
        <a href="/login"> התחברות</a>
        <a href="/signup"> הרשמה</a>
          
      <% } %>
  
    </div>
    
      <script>
        document.getElementById('logoutButton').addEventListener('click', function() {
            // Send a POST request to the logout route
            fetch('/logout', {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                // Handle the response from the server
                if (data.success) {
                    // Successful logout
                    window.location.href = '/'; // Redirect to home page
                } else {
                    // Logout failed
                    console.log(data.message);
                }
            })
            .catch(error => {
                // Handle any errors that occur during the request
                console.log('An error occurred:', error);
            });
        });
    </script>
  
     
    </section>
    
       
    <form action="/search" method="post">
      <div id="id01" class="modal">
   
        <div class="modal-content" action="">
          <div class="container">
              <div class="clearfix">
                  <button type="button" onclick="document.getElementById('id01').style.display='none'" class="cancelbtn">X</button>
                 
                  <h1>חיפוש</h1>
                  <hr>
                  
                  <input type="text" placeholder="חפש לפי שם המוצר" name="name" >
                  <br>
                  
                  <label for="email"><b>סינון</b></label>
                  <br>
                  <div class="label-search">
                  <label>
                    <input type="checkbox" checked="checked" name="sofa" style="margin-bottom:15px" > ספות
                  </label>
                  <label>
                    <input type="checkbox" checked="checked" name="armchair" style="margin-bottom:15px"> כסאות בר
                  </label>
                  <label>
                    <input type="checkbox" checked="checked" name="table" style="margin-bottom:15px"> שולחנות
                  </label>
                  <label>
                    <input type="checkbox" checked="checked" name="chair" style="margin-bottom:15px"> כסאות
                  </label>
                  <label>
                    <input type="checkbox" checked="checked" name="bed" style="margin-bottom:15px"> מיטות
                  </label>
                  <label>
                    <input type="checkbox" checked="checked" name="mirror" style="margin-bottom:15px"> מזרונים
                  </label>
                  <label>
                    <input type="checkbox" checked="checked" name="rug" style="margin-bottom:15px"> חדרי ילדים
                  </label>
          </div>
            <div class="price-input">
              <div class="field">
                <span>מינמום</span>
                <input type="number" class="input-min" value="0">
              </div>
              <div class="separator">-</div>
              <div class="field">
                <span>מקסימום</span>
                <input type="number" class="input-max" value="10000">
              </div>
            </div>
            <div class="slider">
              <div class="progress"></div>
            </div>
            <div class="range-input">
              <input name="min" type="range" class="range-min" min="0" max="10000" value="0" step="100">
              <input name ="max" type="range" class="range-max" min="0" max="10000" value="10000" step="100">
      
              <button type="submit" class="signupbtn">חפש</button>
            </div>
          </div>
         
          </div>
        
        </div>
  
                </div>
              </form>
  
  
  
  

     <!-- Script -->
     <script> let hamMenuIcon = document.getElementById("ham-menu");
        let navBar = document.getElementById("nav-bar");
        let navLinks = navBar.querySelectorAll("li");
        
        hamMenuIcon.addEventListener("click", () => {
          navBar.classList.toggle("active");
          hamMenuIcon.classList.toggle("fa-times");
        });
        navLinks.forEach((navLinks) => {
          navLinks.addEventListener("click", () => {
            navBar.classList.remove("active");
            hamMenuIcon.classList.toggle("fa-times");
          });
        });</script>
        
  <script>
  // Get the modal
  var modal = document.getElementById('id01');
  
  // When the user clicks anywhere outside of the modal, close it
  window.onclick = function(event) {
    if (event.target == modal) {
      modal.style.display = "none";
    }
  }
  
  </script>
  <script>const rangeInput = document.querySelectorAll(".range-input input"),
    priceInput = document.querySelectorAll(".price-input input"),
    range = document.querySelector(".slider .progress");
  let priceGap = 1000;
  
  priceInput.forEach((input) => {
    input.addEventListener("input", (e) => {
      let minPrice = parseInt(priceInput[0].value),
        maxPrice = parseInt(priceInput[1].value);
  
      if (maxPrice - minPrice >= priceGap && maxPrice <= rangeInput[1].max) {
        if (e.target.className === "input-min") {
          rangeInput[0].value = minPrice;
          range.style.left = (minPrice / rangeInput[0].max) * 100 + "%";
        } else {
          rangeInput[1].value = maxPrice;
          range.style.right = 100 - (maxPrice / rangeInput[1].max) * 100 + "%";
        }
      }
    });
  });
  
  rangeInput.forEach((input) => {
    input.addEventListener("input", (e) => {
      let minVal = parseInt(rangeInput[0].value),
        maxVal = parseInt(rangeInput[1].value);
  
      if (maxVal - minVal < priceGap) {
        if (e.target.className === "range-min") {
          rangeInput[0].value = maxVal - priceGap;
        } else {
          rangeInput[1].value = minVal + priceGap;
        }
      } else {
        priceInput[0].value = minVal;
        priceInput[1].value = maxVal;
        range.style.left = (minVal / rangeInput[0].max) * 100 + "%";
        range.style.right = 100 - (maxVal / rangeInput[1].max) * 100 + "%";
      }
    });
  });
  </script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  </body>
  </html>
  
  
  </body>
</html>